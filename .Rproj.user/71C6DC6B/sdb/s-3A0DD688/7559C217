{
    "contents" : "---\ntitle: \"Reproducible research peer assignment 1\"\nauthor: \"vjanes\"\ndate: \"Sunday, December 14, 2014\"\noutput: html_document\n---\n\nPeer assignment one for the Coursera Data Science specialty's *Reproducible research* course.\n\n##Loading and preprocessing the data\n```{r}\nSys.setlocale(\"LC_TIME\", \"English\")\nlibrary(lattice)\n```\n\n## Reading datafiles\n\n```{r}\nunzip(\"activity.zip\")\ndata<-read.csv(\"activity.csv\", colClasses = c(\"integer\",\"Date\",\"integer\"))\n```\n\n##What is mean total number of steps taken per day?\n\n### Aggregating data by day\nUsing aggregate function\n```{r}\nstp_per_day<-aggregate(data$steps, by=list(data$date), \"sum\",na.rm=TRUE, na.action=NULL)\nnames(stp_per_day)<-c(\"date\",\"tt_steps\")\n```\n\n\n### Producing an histogram\nUsing barplot\n\n```{r}\nbarplot(stp_per_day$tt_steps, names.arg=stp_per_day$date,width = 0.1,main=\"Total number of steps by day\")\n```\n\n\n\n### Calculating mean and median \"total steps per day\" values\nUsing common R functions\n\n```{r}\nstp_mean<-mean(stp_per_day$tt_steps)\nstp_med<-median(stp_per_day$tt_steps)  \n  \n```\n\nThe mean number of steps per day is **`r stp_mean`**.  \nThe median number of steps per day is **`r stp_med`**.\n\n##What is the average daily activity pattern?\n\n### Aggregating data by time-period\nUsing aggregate function\n```{r}\nstp_per_tp<-aggregate(data$steps, by=list(data$interval), \"mean\",na.rm=TRUE, na.action=NULL)\nnames(stp_per_tp)<-c(\"interval\",\"mean_steps\")\n```\n\n### Producing an histogram\n\n```{r}\nplot(stp_per_tp$interval,stp_per_tp$mean_steps, type=\"l\",\n     xlab=\"time-period\", ylab=\"mean steps\",main=\"Mean number of steps by time-period\")\n```\n\n### Max time-period\ntime-period with max mean steps:\n\n```{r}\nmax_mean_step_tp<-\n  stp_per_tp[which.max(stp_per_tp$mean_steps),1]\n\nmax_mean_step_val<-round(\n  stp_per_tp[which.max(stp_per_tp$mean_steps),2],digits=2)\n\n```\n\nThe time period with max mean number of steps is interval **`r max_mean_step_tp`**.  \nThe max mean steps value is **`r max_mean_step_val`**.\n\n##Imputing missing values\n\n### Total number of missing values in the dataset\n\n```{r}\nnb_na_rows<-NROW(data[,1])-NROW(na.omit(data[,1]))\n```\nThere are **`r nb_na_rows`** out of `r NROW(data[,1])` rows.\n\n###  Filling in all of the missing values\nIn order to fill missing value we will feed median values for interval in the dataset. In order to do this we'll create a modified datasample names _**datam**_.\n\n```{r}\ndatam<-data\nfor (i in (1:NROW(datam)))\n{\n  if(is.na(datam[i,1]))\n    {datam[i,1]<-\n       stp_per_tp[which(stp_per_tp$interval==datam[i,3]),2]}}\n```\n\n### Producing an histogram for completed data\n\n```{r}\nstp_per_daym<-aggregate(datam$steps, by=list(datam$date), \"sum\",na.rm=TRUE, na.action=NULL)\nnames(stp_per_daym)<-c(\"date\",\"tt_steps\")\nbarplot(stp_per_daym$tt_steps, names.arg=stp_per_day$date,width = 0.1, main = \"Total steps per day, \n completed sample\")\n\n```\n\n\n```{r}\nstp_meanm<-mean(stp_per_daym$tt_steps)\nstp_medm<-median(stp_per_daym$tt_steps)  \n  \n```\n\nThe mean number of steps per day is **`r stp_meanm`** for completed sample.  \nThe median number of steps per day is **`r stp_medm`** for completed sample.  **Both mean and median have slightly increased**.\n\n##Are there differences in activity patterns between weekdays and weekends?\n\n###Defining WE/non-WE days\n\nCreating the WE/non-WE table:\n```{r}\nWE_table<-cbind(\n  rbind(\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"),rbind(\"non_WE\",\"non_WE\",\"non_WE\",\"non_WE\",\"non_WE\",\"WE\",\"WE\"))\ncolnames(WE_table)<-c(\"weekday\",\"is_we\")\n```\nApplying to data, displaying result sample:\n```{r}\ndataw<-cbind(data,weekday=weekdays(data$date))\ndataw<-merge(dataw,WE_table,by=\"weekday\")\n\n##displaying result sample\nsamdataw<-dataw[which(dataw$interval==0),c(3,1,5)]\nsamdataw<-samdataw[order(samdataw$date),]\nrow.names(samdataw) <- NULL \nhead(samdataw[order(samdataw$date),],n=10)\n```\n\n###Comparing WE/non-WE days\n\n```{r}\nstp_interv_we<-aggregate(dataw$steps, by=list(dataw$interval,dataw$is_we), \"mean\",na.rm=TRUE, na.action=NULL)\ncolnames(stp_interv_we)<-c(\"interval\",\"is_we\",\"steps\")\n\nxyplot(steps~interval|is_we, data=stp_interv_we, type=\"l\")\n```\n\n",
    "created" : 1418566381582.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "94768321",
    "id" : "7559C217",
    "lastKnownWriteTime" : 1418586367,
    "path" : "C:/Users/Vincent/rprojects/RepData_PeerAssessment1/RepData_PeerAssessment1_mkd.Rmd",
    "project_path" : "RepData_PeerAssessment1_mkd.Rmd",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}